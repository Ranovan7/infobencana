{% extends 'base.html' %}
{% block content %}
<div class="container">
	<nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('admin.index') }}">Dashboard</a></li>
        <li class="breadcrumb-item active" aria-current="page">Tambah Kejadian</li>
      </ol>
    </nav>

	<h1>Tambah Bencana</h1>
  <form method="POST">
    {{ form.csrf_token() }}
	  <div class="form-row">
	    <div class="col-md-6 mb-3" align="left">
	      {{ form.waktu.label(for="waktu") }}
				{{ form.waktu(class="form-control datepicker", id="waktu") }}
				{% for error in form.waktu.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	    <div class="col-md-6 mb-3" align="left">
				{{ form.jenis.label(for="jenis") }}
	      {{ form.jenis(class="custom-select", id="jenis") }}
				{% for error in form.jenis.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	  </div>
	  <div class="form-row">
	    <div class="col-md-6 mb-3" align="left">
			  {{ form.sebab.label(for="sebab") }}
			  {{ form.sebab(class="form-control", id="sebab") }}
			  {% for error in form.sebab.errors %}
				  <div class="invalid-feedback d-block">
					  {{ error }}
				  </div>
			  {% endfor %}
	    </div>
	    <div class="col-md-6 mb-3" align="left">
				{{ form.nama_sungai.label(for="nama_sungai") }}
	      		{{ form.nama_sungai(class="form-control", id="nama_sungai") }}
				{% for error in form.nama_sungai.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	  </div>
	  <div class="form-row">
	    <div class="col-md-6 mb-3" align="left">
				{{ form.tindakan.label(for="tindakan") }}
	      		{{ form.tindakan(class="form-control", id="tindakan") }}
				{% for error in form.tindakan.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	    <div class="col-md-6 mb-3" align="left">
				{{ form.lama.label(for="lama") }}
				<div class="input-group">
	      	{{ form.lama(class="form-control", id="lama", type="number") }}
					<div class="input-group-append">
				    <span class="input-group-text" id="basic-addon2">Hari</span>
				  </div>
				</div>
				{% for error in form.lama.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	  </div>
		<hr>
		<h3>Kerusakan</h3>
		<div class="form-row">
	    <div class="col-md-4 mb-3" align="left">
				{{ form.sungai.label(for="sungai") }}
	      {{ form.sungai(class="form-control", id="sungai", type="number") }}
				{% for error in form.sungai.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	    <div class="col-md-4 mb-3" align="left">
				{{ form.sawah.label(for="sawah") }}
				<div class="input-group">
	      {{ form.sawah(class="form-control", id="sawah", type="number") }}
				  <div class="input-group-append">
				    <span class="input-group-text" id="basic-addon2">Ha</span>
				  </div>
				</div>
				{% for error in form.sawah.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	    <div class="col-md-4 mb-3" align="left">
				{{ form.bangunan.label(for="bangunan") }}
	      {{ form.bangunan(class="form-control", id="bangunan", type="number") }}
				{% for error in form.bangunan.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	  </div>
	  <div class="form-row">
	    <div class="col-md-4 mb-3" align="left">
				{{ form.jalan.label(for="jalan") }}
				<div class="input-group">
			      {{ form.jalan(class="form-control", id="jalan", type="number") }}
				  <div class="input-group-append">
					<span class="input-group-text" id="basic-addon2">Km</span>
				  </div>
				 </div>
				{% for error in form.jalan.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	    <div class="col-md-4 mb-3" align="left">
				{{ form.jalan_putus.label(for="jalan_putus") }}
				<div class="input-group">
			      {{ form.jalan_putus(class="form-control", id="jalan_putus", type="number") }}
				  <div class="input-group-append">
					<span class="input-group-text" id="basic-addon2">Km</span>
				  </div>
				 </div>
				{% for error in form.jalan_putus.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	    <div class="col-md-4 mb-3" align="left">
				{{ form.jembatan.label(for="jembatan") }}
	      {{ form.jembatan(class="form-control", id="jembatan", type="number") }}
				{% for error in form.jembatan.errors %}
					<div class="invalid-feedback d-block">
						{{ error }}
					</div>
				{% endfor %}
	    </div>
	  </div>
    <div>
      {{ form.submit(value="Tambah", class="btn btn-outline-primary") }}
      <a class="btn btn-outline-danger" href="{{ url_for('admin.index') }}">Kembali</a>
    </div>

  </form>
	<hr>
</div>
{% endblock %}
{% block extra_head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/select2.min.css') }}">
  <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
{% endblock %}
{% block extra_foot %}
<!-- QuillJS HTML Editor -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script src="{{ url_for('static', filename='js/select2.min.js') }}"></script>
  <script>
		$(function() {
			$('#desa').select2({
				tags: true,
				minimumInputLength: 3,
				templateResult: formatResult,
				ajax: {
					url: function (params) {
						return '/api/desa?q=' + params.term;
					},
					dataType: 'json',
					processResults: function(data) {
						console.log(data);
						let rst = $.map(data, function(e) {
							e.id = e.id;
							e.text = e.desa + ' Kec.' + e.kecamatan + ' Kab. ' + e.kabupaten;
							return e;
						});
						return {
							results: rst
						};
					}
				}
			});

			function formatResult(data) {
				return data.desa + ' Kec. ' + data.kecamatan + ' Kab. ' + data.kabupaten;
			}
		});
  </script>
	<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
	<script>
      $('#waktu').datepicker(
					{
							uiLibrary: 'bootstrap4',
							format: "dd-mm-yyyy",
							useCurrent: true
					}
			)

			// log for debugging
			$("#waktu").change(function(){
					let waktu = $('#waktu').val()
					console.log(`Waktu : ${waktu}`)
			})
  </script>
{% endblock %}
